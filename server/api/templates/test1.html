<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC" crossorigin="anonymous">
  <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/2.9.4/Chart.js"></script>
</head>

<body>
  <div class="container bg-light">
    <div class="row bg-warning">
      <div class="text-center pt-1"><b>Báo cáo phân tích SP02</b></div>
      <div class="row my-2">
        <div class="col-md-12 col-lg-6 text-primary">Tổng thời gian đo: {d.totalTime}</div>
        <div class="col-md-12 col-lg-6 text-primary">Ngày đo: {d.measurementDate}</div>
        <div class="col-md-12 col-lg-6 text-primary">Ngưỡng SPO2 theo dõi: {d.oximeterMonitor}%</div>
      </div>

      <div class="row my-4">
        <div class="col-12 text-center"><b>Chỉ số SPO2</b></div>
        <div class="col-md-12 col-lg-6 text-primary">SP02 trung bình: {d.avgSpO2}%</div>
        <div class="col-md-12 col-lg-6 text-primary">SP02 thấp nhất: {d.minOximeter}%</div>

        <div class="col-md-12 col-lg-6 text-primary">SP02 cao nhất: {d.maxOximeter}</div>
        <div class="col-md-12 col-lg-6 text-primary">Tổng thời gian dưới ngưỡng: {d.totalTimeBelowThreshold}</div>
        <div class="col-md-12 col-lg-6 text-primary">Tỷ lệ thời gian dưới ngưỡng: {d.percentBelowThreshold}%</div>
        <div class="col-md-12 col-lg-6 text-primary">Thời gian trung bình mỗi lần dưới ngưỡng: {d.avgTimeBelowThreshold}</div>
        <div class="col-md-12 col-lg-6 text-primary">Tổng số lần dưới ngưỡng: {d.totalBelowThreshold} lần</div>
        <div class="col-md-12 col-lg-6 text-primary">Thời gian dưới ngưỡng dài nhất: {d.maxTimeRange}</div>
      </div>

      <div class="row">
        <div class="col-12 text-center"><b>Nhịp tim</b></div>
        <div class="col-md-12 col-lg-6 text-primary">Nhịp tim thấp nhất: {d.minPulseRate} nhịp/phút</div>
        <div class="col-md-12 col-lg-6 text-primary">Nhịp tim cao nhất: {d.maxPulseRate} nhịp/phút</div>
        <div class="col-md-12 col-lg-6 text-primary">Nhịp tim trung bình: {d.avgPulseRate} nhịp/phút</div>
      </div>

      <div class="row my-4">
        <div class="col-12 text-center"><b>Chỉ số tưới máu (PI)</b></div>
        <div class="col-md-12 col-lg-6 text-primary">PI thấp nhất: {d.minPI}</div>
        <div class="col-md-12 col-lg-6 text-primary">PI cao nhất: {d.maxPI}</div>
        <div class="col-12 text-primary">Chỉ số tưới máu (PI) trung bình: {d.avgPI}</div>
      </div>
    </div>

    <input id="xValues" value={d.xValues} hidden></input>
    <input id="yOxiValues" value={d.yOxiValues} hidden></input>
    <input id="yPulseValues" value={d.yPulseValues} hidden></input>

    <div class="text-center pt-3"><b>Biểu đồ SP02</b></div>
    <canvas id="myChart" style="max-width:100%;"></canvas>
    <div class="text-center pt-3"><b>Biểu đồ nhịp tim</b></div>
    <canvas id="myPulse" style="max-width:100%;"></canvas>
  </div>
  <script>
    window.onload = function(e) {
      const dataX = document.getElementById("xValues").value;
      const yOxiValues = document.getElementById("yOxiValues").value;
      const yPulseValues = document.getElementById("yPulseValues").value;
      const xValues = dataX.split(',');
      const yValues = yOxiValues.split(',');
      const yPulValues = yPulseValues.split(',');

      new Chart("myChart", {
        "type": "line",
        "data": {
          "labels": xValues,
          "datasets": [{
            "fill": false,
            "lineTension": 0.2,
            "backgroundColor": "rgba(0,0,255,1.0)",
            "borderColor": "rgba(0,0,255,1)",
            "data": yValues,
            "borderWidth": 1
          }]
        },
        "options": {
          "legend": {"display": false},
          "scales": {
            "yAxes": [{"ticks": {"min": 70, "max": 110}}],
          },
          "elements": {
            "point":{
              "radius": 0
            }
          }
        }
      });

      new Chart("myPulse", {
        "type": "line",
        "data": {
          "labels": xValues,
          "datasets": [{
            "fill": false,
            "lineTension": 0.2,
            "backgroundColor": "rgba(0,0,255,1.0)",
            "borderColor": "rgba(0,0,255,1)",
            "data": yPulValues,
            "borderWidth": 1
          }]
        },
        "options": {
          "legend": {"display": false},
          "scales": {
            "yAxes": [{"ticks": {"min": 30, "max": 190}}],
          },
          "elements": {
            "point":{
              "radius": 0
            }
          }
        }
      });
    }

  </script>

</body>
</html>



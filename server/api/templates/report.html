<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC" crossorigin="anonymous">
  <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/2.9.4/Chart.js"></script>
</head>

<body>
<div class="container bg-light">
  <div class="row px-4">
    <div class="pt-1"><b>Báo cáo phân tích SP02</b></div>
    <div class="row my-2">
      <div class="col-md-12 text-primary">Tổng thời gian đo: <b>{d.totalTime}</b> (Từ {d.timeStartRecord} đến {d.timeEndRecord})</div>
    </div>

    <div class="row my-4">
      <div class="col-12"><b>Chỉ số SPO2</b></div>
      <div class="col-md-12 text-primary">Ngưỡng SPO2 theo dõi: <b>{d.oximeterMonitor}%</b></div>
      <div class="col-md-12  text-primary">SP02 trung bình: <b>{d.avgSpO2}%</b></div>
      <div class="col-md-12  text-primary">SP02 thấp nhất: <b>{d.minOximeter}%</b></div>
      <div class="col-md-12  text-primary">SP02 cao nhất: <b>{d.maxOximeter}%</b></div>
      <div class="col-md-12  text-primary">Tổng thời gian <= {d.oximeterMonitor}%: <b>{d.totalTimeBelowThreshold}</b></div>
      <div class="col-md-12  text-primary">Tỷ lệ thời gian <= {d.oximeterMonitor}%: <b>{d.percentBelowThreshold}%</b></div>
      <div class="col-md-12  text-primary">Thời gian trung bình mỗi lần <= {d.oximeterMonitor}%: <b>{d.avgTimeBelowThreshold}</b></div>
      <div class="col-md-12  text-primary">Tổng số lần <= {d.oximeterMonitor}%: <b>{d.totalBelowThreshold} lần</b></div>
      <div class="col-md-12  text-primary">Thời gian <= {d.oximeterMonitor}% dài nhất: <b>{d.maxTimeRange}</b> {d.timeRangeThreshold}</div>
    </div>

    <div class="row">
      <div class="col-12"><b>Nhịp tim</b></div>
      <div class="col-md-12  text-primary">Nhịp tim trung bình: <b>{d.avgPulseRate} nhịp/phút</b></div>
      <div class="col-md-12  text-primary">Nhịp tim thấp nhất: <b>{d.minPulseRate} nhịp/phút</b></div>
      <div class="col-md-12  text-primary">Nhịp tim cao nhất: <b>{d.maxPulseRate} nhịp/phút</b></div>
    </div>

    <div class="row my-4">
      <div class="col-12"><b>Chỉ số tưới máu (PI)</b></div>
      <div class="col-12 text-primary">PI trung bình: <b>{d.avgPI}</b></div>
      <div class="col-md-12  text-primary">PI thấp nhất: <b>{d.minPI}</b></div>
      <div class="col-md-12  text-primary">PI cao nhất: <b>{d.maxPI}</b></div>
    </div>
  </div>

  <input id="xValues" value={d.xValues} hidden></input>
  <input id="yOxiValues" value={d.yOxiValues} hidden></input>
  <input id="yPulseValues" value={d.yPulseValues} hidden></input>

  <div class="">
    <div class="pt-3 px-4 text-center" ><b>Biểu đồ SP02</b></div>
    <div class="col-12 px-2 text-center" style="width: 100%;height: auto; margin: auto;">
      <canvas id="myChart" style="margin: auto;"></canvas>
    </div>
    <div class="pt-3 px-4 text-center"><b>Biểu đồ nhịp tim</b></div>
    <div class="col-12 px-2 text-center" style="width: 100%;height: auto; margin: auto;">
      <canvas id="myPulse" style="max-width:100%; height: auto; margin: auto;"></canvas>
    </div>
  </div>
</div>
<script>
  window.onload = function(e) {
    const dataX = document.getElementById("xValues").value;
    const yOxiValues = document.getElementById("yOxiValues").value;
    const yPulseValues = document.getElementById("yPulseValues").value;
    const xValues = dataX.split(',');
    const yValues = yOxiValues.split(',');
    const yPulValues = yPulseValues.split(',');

    new Chart("myChart", {
      "type": "line",
      "data": {
        "labels": xValues,
        "datasets": [{
          "fill": false,
          "lineTension": 0.2,
          "backgroundColor": "rgba(0,0,255,1.0)",
          "borderColor": "rgba(0,0,255,1)",
          "data": yValues,
          "borderWidth": 1
        }]
      },
      "options": {
        "legend": {"display": false},
        "scales": {
          "yAxes": [{"ticks": {"min": 70, "max": 110}}],
        },
        "elements": {"point":{"radius": 0}},
        animation: { duration: 0 },
        hover: { animationDuration: 0 },
        responsiveAnimationDuration: 0,
        responsive:true,
        maintainAspectRatio: false
      }
    });

    new Chart("myPulse", {
      "type": "line",
      "data": {
        "labels": xValues,
        "datasets": [{
          "fill": false,
          "lineTension": 0.2,
          "backgroundColor": "rgba(0,0,255,1.0)",
          "borderColor": "rgba(0,0,255,1)",
          "data": yPulValues,
          "borderWidth": 1
        }]
      },
      "options": {
        "legend": {"display": false},
        "scales": {
          "yAxes": [{"ticks": {"min": 30, "max": 190}}],
        },
        "elements": {"point":{"radius": 0}},
        animation: { duration: 0 },
        hover: { animationDuration: 0 },
        responsiveAnimationDuration: 0,
        responsive:true,
        maintainAspectRatio: false
      }
    });
  }

</script>

</body>
</html>


